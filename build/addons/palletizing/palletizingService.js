function palletizingService(a,b,c,d,e,f,g,h,i,j,k,l,m,n){function o(){u.dragHandler.dragged.originalPosition<0||u.project.current.layerOrder.splice(u.dragHandler.dragged.originalPosition,0,{id:u.dragHandler.dragged.id,type:"layer"})}function p(){angular.forEach(u.project.current.layerOrder,function(a){a.temp&&u.project.current.layerOrder.splice(u.project.current.layerOrder.indexOf(a),1)})}function q(){angular.forEach(u.project.current.layerOrder,function(a){a.temp&&delete a.temp})}function r(a){p(),u.project.current.layerOrder.splice(a,0,{id:u.dragHandler.dragged.id,temp:!0,type:"layer"})}function s(a,b){var c=a.outerWidth(),d=a.outerHeight(),e=a.offset(),f=new Object;if(e){f.top=e.top+d,f.left=e.left+c;var g={top:b.y,left:b.x+k.beltWidth};return g.left>e.left&&g.left<f.left&&g.top>e.top&&g.top<f.top}}var t=["#FFF7A5","#FFA5E0","#A5B3FF","#BFFFA5","#FFCBA5"],u={demo:{video:"palletDemo.mp4",timeout:null,sec:60,prevScreen:null,close:function(){u.demo.prevScreen&&"Demo"!=u.demo.prevScreen||(u.demo.prevScreen="Pallet Projects"),i.setCurrentScreenByName(u.demo.prevScreen)},start:function(){$("body").click(u.demo.restart),u.demo.timeout=m(function(){u.demo.prevScreen=i.currentScreen.properties.name,i.setCurrentScreenByName("Demo")},1e3*u.demo.sec)},stop:function(){$("body").unbind("click",u.demo.restart),u.demo.timeout&&m.cancel(u.demo.timeout)},restart:function(){u.demo.stop(),u.demo.start()}},monitor:{pallets:0,currentProject:null,draggedLayer:null,currentLayer:0,currentItem:0,reset:function(){u.monitor.pallets=0,u.monitor.currentLayer=0,u.monitor.currentItem=0},step:function(){u.monitor.currentItem++;u.monitor.currentProject;u.getLayer(u.monitor.currentProject.layerOrder[u.monitor.currentLayer].id,u.monitor.currentProject.layers).boxes.length==u.monitor.currentItem&&(u.monitor.currentItem=0,u.monitor.currentLayer++,u.monitor.currentLayer==u.monitor.currentProject.layerOrder.length&&(u.monitor.currentLayer=0,u.monitor.pallets++)),u.monitor.startTimer()},stopTimer:function(){u.monitor.stepTimer&&(m.cancel(u.monitor.stepTimer),delete u.monitor.stepTimer)},startTimer:function(){u.monitor.stopTimer(),u.monitor.stepTimer=m(u.monitor.step,1e3)},pause:function(){u.monitor.isPaused?u.monitor.startTimer():u.monitor.stopTimer()},getItemCount:function(a){var b=0;return angular.forEach(this.currentProject.layerOrder,function(c,d){if(!a||d<=u.monitor.currentLayer){var e=u.getLayer(c.id,u.monitor.currentProject.layers);b+=a&&d==u.monitor.currentLayer?u.monitor.currentItem:e.boxes.length}}),b}},windowSize:function(){return{w:$(window).width(),h:$(window).height()}},icons:{layer:d.trustAsResourceUrl(c.addonServerUrl+"addons/palletizing/images/layer.png"),overLayer:d.trustAsResourceUrl(c.addonServerUrl+"addons/palletizing/images/overLayer.png")},disableEditMode:!1,screens:[{name:"Pallet Projects",type:"palletizing",html:d.trustAsResourceUrl(c.addonServerUrl+"addons/palletizing/views/screens/projects.html"),hasScreen:!0,icon:"data:image/png;base64,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"},{name:"Project",type:"palletizing",html:d.trustAsResourceUrl(c.addonServerUrl+"addons/palletizing/views/screens/project.html")},{name:"Layer editor",type:"palletizing",html:d.trustAsResourceUrl(c.addonServerUrl+"addons/palletizing/views/screens/layerEditor.html")},{name:"Final step",type:"palletizing",html:d.trustAsResourceUrl(c.addonServerUrl+"addons/palletizing/views/screens/finalStep.html")},{name:"Pallet Monitor",type:"palletizing",html:d.trustAsResourceUrl(c.addonServerUrl+"addons/palletizing/views/screens/palletMonitor.html"),hasScreen:!0,icon:"data:image/png;base64,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"},{name:"Simulate",type:"palletizing",html:d.trustAsResourceUrl(c.addonServerUrl+"addons/palletizing/views/screens/simulate.html"),hasScreen:!1},{name:"Demo",type:"palletizing",html:d.trustAsResourceUrl(c.addonServerUrl+"addons/palletizing/views/screens/demo.html"),hasScreen:!1}],enabled:!1,projects:[],boxes:[{w:100,l:150,h:100,name:"Box 1",type:"box",rotation:0,color:t[0]},{w:90,l:60,h:100,name:"Box 2",type:"box",rotation:0,color:t[1]},{w:150,l:25,h:100,name:"Box 3",type:"box",rotation:0,color:t[2]},{w:200,l:100,h:100,name:"Box 4",type:"box",rotation:0,color:t[3]}],getLayer:function(a,b){b||(b=u.project.current.layers);var c=null;return angular.forEach(b,function(b){b.id==a&&(c=b)}),c},save:function(){l.save(!0)},setEnabled:function(){this.enabled?(x(),y(),u.demo.enabled&&m(u.demo.start,0)):(x(),u.demo.stop())},project:{current:null,select:function(a){a.isNew=!1,u.project.current=a,u.layer.overLayer=null},save:function(){1==u.project.current.isNew&&(delete u.project.current.isNew,u.projects.push(u.project.current)),u.save(),i.setCurrentScreenByName("Pallet Projects")},close:function(){u.project.current=null,i.setCurrentScreenByName("Pallet Projects")},remove:function(){bootbox.confirm("Do you want to remove the selected project?",function(a){a&&(u.projects.splice(u.projects.indexOf(u.project.current),1),u.project.current=null,u.save(),delete u.project.current,c.$apply())})},create:function(){u.project.current={layers:[],layerOrder:[],isNew:!0,name:"New pallet "+(u.projects.length+1),length:1200,width:800,height:144},u.layer.overLayer=null,i.setCurrentScreenByName("Project")},edit:function(){i.setCurrentScreenByName("Project")},removeAll:function(){bootbox.confirm("Do you want to remove all palletizing projects?",function(a){a&&(u.projects=[],u.save(),delete u.project.current,c.$apply())})},finish:function(){i.setCurrentScreenByName("Final step")},generate:function(){f.show("Not connected to robot...")},onDimensionChanged:function(){u.dimChangedTimeout&&m.cancel(u.dimChangedTimeout),u.dimChangedTimeout=m(function(){(null==u.project.current.width||u.project.current.width<0)&&(u.project.current.width=0),(null==u.project.current.length||u.project.current.length<0)&&(u.project.current.length=0),(null==u.project.current.height||u.project.current.height<0)&&(u.project.current.height=0)},500)}},layer:{intersected:[],current:null,overLayer:null,select:function(a){u.layer.current=a},selectOverlay:function(a){u.layer.overLayer=u.getLayer(a.id)},selectById:function(a){var b=u.getLayer(a);u.layer.current=b},save:function(){u.layer.current.isNew&&(delete u.layer.current.isNew,u.project.current.layers.push(u.layer.current)),u.save(),i.setCurrentScreenByName("Project")},close:function(){u.layer.current=null,i.setCurrentScreenByName("Project")},edit:function(){u.layer.selectById(u.dragHandler.dragged.id),i.setCurrentScreenByName("Layer editor")},remove:function(){u.layer.selectById(u.dragHandler.dragged.id),bootbox.confirm("Do you want to remove the selected layer type from the project?",function(a){if(a){for(var b=u.layer.current.id,d=0;d<u.project.current.layerOrder.length;){var e=u.project.current.layerOrder[d];e.id==b?u.project.current.layerOrder.splice(d,1):d++}u.project.current.layers.splice(u.project.current.layers.indexOf(u.layer.current),1),u.layer.current=null,c.$apply()}})},create:function(){u.layer.current={boxes:[],name:"Layer "+(u.project.current.layers.length+1),isNew:!0,id:h.guid(),type:"layer"},i.setCurrentScreenByName("Layer editor")},removeAll:function(){bootbox.confirm("Do you want to remove all layer types from the project?",function(a){a&&(u.project.current.layers=[],u.project.current.layerOrder=[],u.save(),c.$apply())})},setOverlay:function(a){u.layer.overLayer=a},isIntersected:function(a){var b=!1;return angular.forEach(u.layer.intersected,function(c){(c.b1==a||c.b2==a)&&(b=!0)}),b},getIntersections:function(){function a(a,b){var c={x:a.palletLeft+a.l/2,y:a.palletTop+a.w/2},d={x:b.palletLeft+b.l/2,y:b.palletTop+b.w/2},e={x:a.rotation%180==0?a.l:a.w,y:a.rotation%180==0?a.w:a.l},f={x:b.rotation%180==0?b.l:b.w,y:b.rotation%180==0?b.w:b.l},g={left:c.x-e.x/2,right:c.x+e.x/2,top:c.y-e.y/2,bottom:c.y+e.y/2},h={left:d.x-f.x/2,right:d.x+f.x/2,top:d.y-f.y/2,bottom:d.y+f.y/2};return!(h.left>=g.right||h.right<=g.left||h.top>=g.bottom||h.bottom<=g.top)}var b=[];if(u.layer.current)return angular.forEach(u.layer.current.boxes,function(c){angular.forEach(u.layer.current.boxes,function(d){c&&d&&a(c,d)&&c!=d&&b.push({b1:c,b2:d})})}),b},auto:{boxTypes:{},visible:!1,selectedLayout:null,setVisible:function(a,b){u.layer.auto.visible=a,b&&u.layer.auto.selectedLayout&&(u.layer.current.boxes=angular.copy(u.layer.auto.selectedLayout.blocks),u.layer.auto.selectedLayout=null,u.layer.intersected=u.layer.getIntersections())},layouts:[],getLayouts:function(){u.layer.auto.layouts=[],u.layer.auto.boxTypes={},angular.forEach(u.layer.current.boxes,function(a){u.layer.auto.boxTypes[a.name]||(u.layer.auto.boxTypes[a.name]=a,u.layer.auto.boxTypes[a.name].num=0,u.layer.auto.boxTypes[a.name].area=a.w*a.l),u.layer.auto.boxTypes[a.name].num++});for(var a=0;10>a;a++)u.layer.auto.layouts.push(u.layer.auto.run(u.layer.auto.boxTypes,a))},regenerate:function(){u.layer.auto.layouts=[];for(var a=0;10>a;a++)u.layer.auto.layouts.push(u.layer.auto.run(u.layer.auto.boxTypes,a))},run:function(a,b){var c=[],d={coverage:0},e="Original fit";if(c=[],angular.forEach(a,function(a){for(var d=0;d<a.num;d++)switch(b){case 0:c.push({w:a.l,h:a.w,area:a.l*a.w,rotation:a.rotation,name:a.name,color:a.color,name:a.name});break;case 1:e="Rotated fit",c.push({w:a.w,h:a.l,area:a.l*a.w,rotation:a.rotation+90,color:a.color,name:a.name});break;default:e="Random fit";var f=Math.random()<.5;f?c.push({w:a.w,h:a.l,area:a.l*a.w,rotation:a.rotation+90,color:a.color,name:a.name}):c.push({w:a.l,h:a.w,area:a.l*a.w,rotation:a.rotation,color:a.color,name:a.name})}}),1==c.length)for(var f=0;f<Math.round(u.project.current.length*u.project.current.width/c[0].area);f++)c.push(angular.copy(c[0]));var g=new Packer(u.project.current.length/2,u.project.current.width/2);u.layer.auto.sort.now(c,"maxside"),g.fit(c),d=u.layer.auto.report(c,g.root.w,g.root.h);var h=[];return angular.forEach(d.blocks,function(a){a.fit&&h.push({top:a.fit.y+$("#pallet").position().top,left:a.fit.x+$("#pallet").position().left,palletTop:Math.floor(a.fit.y),palletLeft:Math.floor(a.fit.x),w:a.h,l:a.w,type:"box",rotation:0,color:a.color,name:a.name})}),{blocks:h,coverage:d.coverage,method:e}},report:function(a,b,c){var d,e,f=0,g=[],h=a.length,i=[];for(e=0;h>e;e++)d=a[e],d.fit?(f+=d.area,i.push(d)):g.push(""+d.w+"x"+d.h);return{coverage:Math.round(100*f/(b*c)),blocks:i}},sort:{random:function(a,b){return Math.random()-.5},w:function(a,b){return b.w-a.w},h:function(a,b){return b.h-a.h},a:function(a,b){return b.area-a.area},max:function(a,b){return Math.max(b.w,b.h)-Math.max(a.w,a.h)},min:function(a,b){return Math.min(b.w,b.h)-Math.min(a.w,a.h)},height:function(a,b){return u.layer.auto.sort.msort(a,b,["h","w"])},width:function(a,b){return u.layer.auto.sort.msort(a,b,["w","h"])},area:function(a,b){return u.layer.auto.sort.msort(a,b,["a","h","w"])},maxside:function(a,b){return u.layer.auto.sort.msort(a,b,["max","min","h","w"])},msort:function(a,b,c){var d,e;for(e=0;e<c.length;e++)if(d=u.layer.auto.sort[c[e]](a,b),0!=d)return d;return 0},now:function(a,b){a.sort(u.layer.auto.sort[b])}}}},dragHandler:{touchActionTime:null,dragged:null,dPos:null,mouseDownPos:null,onTemplateMouseDown:function(a,b){u.dragHandler.dPos={x:parseInt("box"==a.type?$("#touchArea").position().left+parseInt($("#touchArea").css("margin-left")):0),y:parseInt("box"==a.type?$("#touchArea").position().top:0)};var d=v(b),e=angular.copy(a);e.top=d.y,e.left=d.x,e.originalPosition=-1,e.posBeforeDrag={top:e.top,left:e.left},"box"==e.type&&(e.dragWatcher=c.$watchGroup([function(){return u.dragHandler.dragged.left},function(){return u.dragHandler.dragged.top}],function(){var a=$("#pallet").position();u.dragHandler.dragged.palletTop=u.dragHandler.dragged.top-a.top,u.dragHandler.dragged.palletLeft=u.dragHandler.dragged.left-a.left}),u.layer.current.boxes.push(e),u.layer.auto.getLayouts()),u.dragHandler.dragged=e,u.dragHandler.mouseDownPos=d},onDoubletap:function(a){a.rotation+=90,a.rotation>=360&&(a.rotation-=360),u.dragHandler.touchActionTime=new Date},onMouseDown:function(a,b,d){if(!u.dragHandler.dragged){var e=v(b);switch(a.posBeforeDrag={top:a.top,left:a.left},u.dragHandler.mouseDownPos=e,a.type){case"layer":if(a.posBeforeDrag={top:e.y,left:e.x},d){var f=u.project.current.layerOrder.indexOf(a);u.project.hiddenLayer=a,a.originalPosition=f}a.name=u.getLayer(a.id).name,u.dragHandler.dragged=angular.copy(a),w(u.dragHandler.dragged,e);break;case"box":a.posBeforeDrag={top:a.top,left:a.left},u.dragHandler.dragged=a,u.dragHandler.dragged.dragWatcher=c.$watchGroup([function(){return u.dragHandler.dragged.left},function(){return u.dragHandler.dragged.top}],function(){var a=$("#pallet").position();u.dragHandler.dragged.palletTop=u.dragHandler.dragged.top-a.top,u.dragHandler.dragged.palletLeft=u.dragHandler.dragged.left-a.left})}}},onMouseMove:function(a){if(u.dragHandler.dragged){var b=v(a);if(w(u.dragHandler.dragged,b),"layer"==u.dragHandler.dragged.type)if(s($("#layers"),b)){var c=u.project.current.layerOrder.length;angular.forEach($("#layers .layer"),function(a){s($(a),b)&&(c=u.project.current.layerOrder.indexOf($(a).scope().item))}),r(c)}else p(),$(".layerAction").removeClass("over"),s($("#editLayer"),b)&&$("#editLayer").addClass("over"),s($("#removeLayer"),b)&&$("#removeLayer").addClass("over"),s($("#overLayer"),b)&&$("#overLayer").addClass("over")}},onMouseUp:function(a){if(u.dragHandler.dragged){delete u.dragHandler.dPos;var b=v(a);if("box"==u.dragHandler.dragged.type?(u.dragHandler.dragged.dragWatcher(),s($("#pallet"),b)||(u.layer.current.boxes.splice(u.layer.current.boxes.indexOf(u.dragHandler.dragged),1),u.layer.auto.getLayouts())):s($("#layers"),b)?q():p(),s($("#editLayer"),b)&&(u.layer.edit(),o()),s($("#removeLayer"),b)&&(u.layer.remove(),o()),s($("#overLayer"),b)&&(u.layer.selectOverlay(u.dragHandler.dragged),o()),$(".layerAction").removeClass("over"),delete u.dragHandler.dragged.posBeforeDrag,delete u.dragHandler.mouseDownPos,u.dragHandler.dragged=null,u.project.hiddenLayer){var c=u.project.current.layerOrder.indexOf(u.project.hiddenLayer);u.project.current.layerOrder.splice(c,1),u.project.hiddenLayer=null}}}}};Object.defineProperty(u.demo,"enabled",{get:function(){var a="true"==localStorage.getItem("palletizingDemoEnabled")?!0:!1;return a},set:function(a){localStorage.setItem("palletizingDemoEnabled",a),a?u.demo.start():u.demo.stop()}});var v=function(a){if(void 0==a)var b={x:event.clientX,y:event.clientY};else var b=a.center;return b.top&&(b.y=b.top),b.left&&(b.x=b.left),delete b.top,delete b.left,b.x-=k.beltWidth,u.dragHandler.dPos&&(b.x-=u.dragHandler.dPos.x,b.y-=u.dragHandler.dPos.y),b},w=function(a,b){a.left=a.posBeforeDrag.left+b.x-u.dragHandler.mouseDownPos.x,a.top=a.posBeforeDrag.top+b.y-u.dragHandler.mouseDownPos.y,"box"==a.type&&(u.dragHandler.touchActionTime=new Date)},x=function(){for(var a=0;a<i.screens.length;){for(var b=i.screens[a],c=!1,d=0;d<u.screens.length;d++)u.screens[d].name==b.properties.name&&(i.screens.splice(i.screens.indexOf(b),1),c=!0);c||a++}},y=function(){var a=n.path().substring(1),b=!1;angular.forEach(u.screens,function(c){var d=i.getScreen(c.name,c.type);d.properties.logoPosition="bottomRight",d.hidden=!c.hasScreen,d.html=c.html,d.indexImage=c.icon,d.editDisabled=!0,i.screens.push(d),a==c.name&&(b=!0)}),b&&i.setCurrentScreenByName(a)};b.screenTypesEnum.Palletizing="palletizing",i.extraParamGetters.push(function(a){return a.palletizing={projects:u.projects,enabled:u.enabled},a}),i.extraCleanParamGetters.push(function(a){return a.palletizing={projects:[],enabled:!1},a}),i.extraParamSetters.push(function(a){a.palletizing&&(u.projects=a.palletizing.projects,u.enabled=a.palletizing.enabled)});c.$watch(function(){return i.loaded},function(a){a&&(u.demo.enabled&&m(u.demo.start,0),m(function(){if(!c.hasPredefinedView){var a=$("#currentScreen .screen"),b=a.scope();a.append(j('<div class="predefinedView" style="width: 100%; height: 100%; top: 0px; position: absolute;" ng-if="project.currentScreen.html"><ng-include src="project.currentScreen.html"></ng-include></div>')(b)),c.hasPredefinedView=!0}},1e3),onCurrentScreenChanged=function(a){if(a)switch(u.layer.currentWatcher&&u.layer.currentWatcher(),a){case"Pallet Projects":u.disableEditMode=!0,u.project.current=null,u.layer.current=null;break;case"Project":u.disableEditMode=!0,null==u.project.current&&i.setCurrentScreenByName("Pallet Projects"),u.layer.current=null;break;case"Simulate":u.disableEditMode=!0,u.layer.current=null,null==u.project.current&&i.setCurrentScreenByName("Pallet Projects");break;case"Layer editor":u.disableEditMode=!0,(null==u.project.current||null==u.layer.current)&&i.setCurrentScreenByName("Pallet Projects"),u.layer.currentWatcher=c.$watchGroup([function(){return u.dragHandler.touchActionTime},function(){return u.layer.current.boxes.length}],function(a,b){if(u.layer.current){u.layer.intersected=u.layer.getIntersections();var c=0;angular.forEach(u.layer.current.boxes,function(a){c+=a.w*a.l*4}),u.layer.current.coverage=Math.round(100*c/(u.project.current.width*u.project.current.length))}});break;case"Final step":u.disableEditMode=!0,null==u.project.current&&i.setCurrentScreenByName("Pallet Projects");break;case"Pallet Monitor":u.disableEditMode=!0,u.monitor.currentProject=u.projects[0]||{name:"N / A"},u.monitor.startTimer();break;default:u.disableEditMode=!1}},u.enabled&&(x(),m(y)),u.currentScreenWatcher&&u.currentScreenWatcher(),u.currentScreenWatcher=c.$watch(function(){return i.currentScreen?i.currentScreen.properties.name:""},onCurrentScreenChanged))});return angular.forEach(Object.keys(localization.items),function(a){localization.items[a].settings.tabs.palletizing={title:"Palletizing",enabled:"Enabled",enableLabel:"Check to enable palletizing functionality",demo:"Demo mode",demoEnableLabel:"Check to enable demo mode"},localization.items[a].help.palletizing={header:"Palletizing",content:"Check enable checkbox to enable palletizing functionality"
}}),$.get(c.addonServerUrl+"addons/palletizing/styles/palletizing.css",function(a){var b=document.createElement("style"),c=document.getElementsByTagName("head")[0]||document.documentElemen;b.type="text/css",b.textContent=b.text=a,c.appendChild(b,c.firstChild)}),e.settings.palletizing={"for":localization.currentLocal.help.palletizing.header,source:c.addonServerUrl+"addons/palletizing/views/help/palletizing.html"},Object.defineProperty(u.monitor,"progress",{get:function(){return 100*u.monitor.getItemCount(!0)/u.monitor.getItemCount()}}),Object.defineProperty(u.project,"totalHeight",{get:function(){var a=u.project.current?u.project.current.height:0;return angular.forEach(u.project.current.layerOrder,function(b){var c=0,d=u.getLayer(b.id);angular.forEach(d.boxes,function(a){a&&a.h>c&&(c=a.h)}),a+=c}),a}}),Object.defineProperty(u.monitor,"isPaused",{get:function(){return null==u.monitor.stepTimer?!0:!1}}),$.getScript(c.addonServerUrl+"addons/palletizing/scripts/3rdParty/packer.js",function(){$.getScript(c.addonServerUrl+"addons/palletizing/scripts/3rdParty/packer.growing.js",function(){})}),c.addModal("autoFillSelector",d.trustAsResourceUrl(c.addonServerUrl+"addons/palletizing/views/autoFillSelector.html"),"$rootScope.palletizing.layer.auto.visible"),c.settingsTabs.palletizing={help:e.settings.palletizing,position:12,source:c.addonServerUrl+"addons/palletizing/views/settings/palletizing.html",title:localization.currentLocal.settings.tabs.palletizing.title},c.settingsTabs.addons.children.push(c.settingsTabs.palletizing),u}palletizingService.$inject=["settingsWindowService","enumService","$rootScope","$sce","helpService","popupService","deviceService","variableService","projectService","$compile","editorService","projectStorageService","$timeout","$location"];