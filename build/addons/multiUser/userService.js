function userService(a,b,c,d,e,f,g,h,i,j,k,l,m,n){m.add("images/login.png",a.addonServerUrl+"addons/multiUser/");var o={username:"admin",password:null,adminPassword:null,confirmPassword:null,adminEnabled:!1,logoutBtn:{title:'<span class="glyphicon glyphicon-log-out" aria-hidden="true"></span>'+localization.currentLocal.login.logout,action:function(){f.setVisible(!1),o.logout()},type:"btn-danger"},accessLevel:b.accessLevelsEnum.LoggedOut,isLoginVisible:!1,setLoginVisible:function(a){o.isLoginVisible=a},login:function(a,c){$.md5("admin");if("guest"==a)return o.accessLevel=b.accessLevelsEnum.Guest,void(o.isLoginVisible=!1);if("admin"==a){var d=i.password;$.md5(c)==d?o.loginSuccess():o.loginFailed()}else o.loginFailed()},loginSuccess:function(){o.accessLevel=b.accessLevelsEnum.Admin,this.callBackAfterLogin&&(this.callBackAfterLogin(),delete o.callBackAfterLogin),o.isLoginVisible=!1},clearAdminPassword:function(){o.adminPassword=""},loginFailed:function(){c.show(localization.currentLocal.login.loginError,c.types.warning)},logout:function(){o.accessLevel=b.accessLevelsEnum.LoggedOut,c.show(localization.currentLocal.login.logoutSuccess),i.forceScreenBelt=!1,o.password=null},hasRole:function(a){return o.accessLevel==b.accessLevelsEnum.Admin&&i.adminEnabled||!i.adminEnabled},save:function(){if(o.adminEnabled&&o.adminPassword==o.confirmPassword){o.accessLevel=b.accessLevelsEnum.Admin;var a=$.md5(o.adminPassword);i.password=a,i.adminEnabled=o.adminEnabled,l.save(!1),o.adminPassword=a}else o.adminEnabled&&o.adminPassword!=o.confirmPassword?c.show(localization.currentLocal.settings.tabs.userMode.passwordError):o.adminEnabled||(i.adminEnabled=o.adminEnabled,l.save(!1))}};return $.getScript(a.addonServerUrl+"addons/multiUser/scripts/3rdParty/jquery.md5.js",function(){$.md5("admin");o.adminPassword=i.password,a.addModal("loginWindow",h.trustAsResourceUrl(a.addonServerUrl+"addons/multiUser/views/loginWindow.html"),"$rootScope.user.isLoginVisible"),a.$watch(function(){return i.adminEnabled},function(b){o.adminEnabled=b;var c=a.extraButtonsForSettingsWindow.indexOf(o.logoutBtn);c>-1&&a.extraButtonsForSettingsWindow.splice(c,1),b&&a.extraButtonsForSettingsWindow.push(o.logoutBtn)}),d.editModeAccesibilities.push(function(){return o.hasRole("admin")}),d.addScreenAccesibilities.push(function(){return o.hasRole("admin")}),d.onIsEditNotAvailable.push(function(a){o.setLoginVisible(!0),o.callBackAfterLogin=a}),k.settings.userMode={"for":localization.currentLocal.help.userMode.header,source:a.addonServerUrl+"addons/multiUser/views/help/userMode.html"},a.settingsTabs.userMode={help:k.settings.userMode,position:11,source:a.addonServerUrl+"addons/multiUser/views/settings/userMode.html",title:localization.currentLocal.settings.tabs.userMode.title},a.settingsTabs.addons.children.push(a.settingsTabs.userMode),a.screenAddons.push(h.trustAsResourceUrl(a.addonServerUrl+"addons/multiUser/views/loginSwitch.html"))}),o}userService.$inject=["$rootScope","enumService","popupService","editorService","$timeout","settingsWindowService","$injector","$sce","projectService","deviceService","helpService","projectStorageService","iconService","$compile"];