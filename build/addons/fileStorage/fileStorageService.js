function fileStorageService(a,b,c,d,e,f,g){var h={storageUrl:"http://"+f.ip+":16735",urlChanged:function(){h.selectedFile=document.getElementById("fileinput"),b.$apply()},selectedFile:null,uploading:!1,files:[],deleteFile:function(a){$.ajax({url:h.getFileUrl(a)+"?delete",type:"GET",dataType:"text",processData:!1,success:function(a){h.updateFileList()}})},updateFileList:function(){$.getJSON(h.storageUrl+"/files",function(a){b.$apply(function(){h.files=a.sort()})})},getFileUrl:function(a){return h.storageUrl+"/files/"+a},download:function(a){var b=h.getFileUrl(a);window.open(b,"_system")},upload:function(){function a(a,c){b.$apply(function(){delete b.blockMessage,e.show(a,c),h.updateFileList(),h.uploading=!1})}var c=document.getElementById("fileinput"),d=c.value.split(/(\\|\/)/g).pop(),f=c.files[0];h.uploading=!0,b.blockMessage=localization.currentLocal.settings.tabs.fileStorage.uploading,$.ajax({url:h.storageUrl+"/files/"+d,type:"POST",data:f,processData:!1,success:function(){a(localization.currentLocal.settings.tabs.fileStorage.uploadSuccess)},fail:function(){a(localization.currentLocal.settings.tabs.fileStorage.uploadFailed,e.types.error)},error:function(){a(localization.currentLocal.settings.tabs.fileStorage.uploadFailed,e.types.error)}})}};return angular.forEach(Object.keys(localization.items),function(a){localization.items[a].settings.tabs.fileStorage={upload:"Upload",file:"File",title:"File storage",uploadSuccess:"File upload finished",uploadFailed:"File upload failed",uploading:"Uploading",download:"Download",downloadAll:"Download all",fileList:"File list",noFiles:"No files found..."},localization.items[a].help.fileStorage={header:"File storage",content:"File storage help"}}),g.getFileUrl=function(a){return h.getFileUrl(a)},d.settings.fileStorage={"for":localization.currentLocal.help.fileStorage.header,source:b.addonServerUrl+"addons/fileStorage/views/help/fileStorage.html"},b.settingsTabs.fileStorage={help:d.settings.fileStorage,position:12,source:b.addonServerUrl+"addons/fileStorage/views/settings/fileStorage.html",title:localization.currentLocal.settings.tabs.fileStorage.title},b.settingsTabs.addons.children.push(b.settingsTabs.fileStorage),h.updateFileList(),h}fileStorageService.$inject=["settingsWindowService","$rootScope","$sce","helpService","popupService","deviceService","variableService"];